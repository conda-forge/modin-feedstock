# Updating the Conda Feedstock

Once the new release is finalized, a bot will open a PR on this repository in order to update the conda feedstock. CI will probably fail on this PR, because there is a patch that we need to manually update. This patch remove dependencies from `setup.py` in the Modin repository. You'll need to update the dependencies in `recipe/meta.yaml` based on this patch.

You can either push directly to the bot's PR in order to make these changes, or you can make these changes to your fork of the modin-feedstock repo. If you are using your fork of the modin-feedstock repo, an ideal way to start is to add the [bot's fork](https://github.com/regro-cf-autotick-bot/modin-feedstock.git) as a remote, and work off of its branch for the release - opening your own PR when you're done.

## Creating the Commit for the Patch

Inside either your fork of Modin, or the release copy you cloned in order to build the pip package, checkout either:

* The release branch (if working on releasing a patch version)
* Modin's master branch (if working on a major or a minor version)

Once you've checked out these files, you'll need to replace the following list entries with empty lists in `setup.py`:

* `dask_deps`
* `ray_deps`
* `mpi_deps`
* `spreadsheet_deps`
* `install_requires`

Once you've set these entries to empty lists, commit the file with the commit message "Remove dependencies from setup.py."

## Building the Patch

Once you've committed the above commit, run `git format-patch -1 HEAD`. This will output a filename corresponding to the commit above. Replace patch in the feedstock repo with the corresponding patch generated by this command.

## Updating `recipe/meta.yaml`

Once you've added the patch to the repo, you'll need to update the recipes in `recipe/meta.yaml` with the dependencies you've removed. Go through each recipe, and make sure that the specified version matches the version pinned in `setup.py`. Once you've updated these recipes, your PR should be good to go!
